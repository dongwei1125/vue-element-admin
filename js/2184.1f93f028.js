"use strict";(self["webpackChunkvue_element_admin"]=self["webpackChunkvue_element_admin"]||[]).push([[2184],{82184:function(e,l,a){a.r(l),a.d(l,{default:function(){return C}});var t=function(){var e=this,l=e._self._c;return l("div",{staticClass:"upload-excel-page"},[l("upload-excel",{attrs:{"on-success":e.handleSuccess,"before-upload":e.beforeUpload}}),l("el-table",{attrs:{data:e.tableData}},[e._l(e.headers,function(a,t){return[a.children?.length?l("el-table-columns",{key:t,attrs:{column:a}}):l("el-table-column",e._b({key:t},"el-table-column",a,!1))]})],2)],1)},o=[],n=function(){var e=this,l=e._self._c;return l("el-upload",{staticClass:"upload-excel",attrs:{action:"#",drag:"","show-file-list":!1,accept:e.accept,"http-request":e.httpRequest,"before-upload":e.onBeforeUpload}},[l("i",{staticClass:"el-icon-upload"}),l("span",{staticClass:"upload-excel-text",domProps:{innerHTML:e._s(e.$t("uploadExcel.tips"))}})])},s=[],r=a(32116),p={uploadExcel:{tips:"Please drag the file here, or <em>click upload</em>",onlyXlsx:"Xlsx or xls only"}},c={uploadExcel:{tips:"将文件拖到此处，或<em>点击上传</em>",onlyXlsx:"仅限 xlsx/xls 格式"}},i={beforeCreate(){this.$i18n.mergeLocaleMessage("en",p),this.$i18n.mergeLocaleMessage("zh",c)}},u={name:"UploadExcel",mixins:[i],props:{beforeUpload:Function},data(){return{accept:".xlsx, .xls",fileTypes:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"]}},methods:{onBeforeUpload(e){return this.fileTypes.includes(e.type)?this.beforeUpload?this.beforeUpload(e):void 0:(this.$message.warning(this.$t("uploadExcel.onlyXlsx")),!1)},httpRequest({file:e}){const l=new FileReader;l.readAsArrayBuffer(e),l.onload=()=>{const e=r.LF(l.result,{type:"array"}),[a]=e.SheetNames,t=e.Sheets[a];r.Wp.sheet_to_json(t)}}}},d=u,b=a(81656),m=(0,b.A)(d,n,s,!1,null,"636c966a",null),h=m.exports,f=function(){var e=this,l=e._self._c;return l("el-table-column",e._b({},"el-table-column",e.column,!1),[e._l(e.column.children,function(a,t){return[a.children?.length?l("el-table-columns",{key:t,attrs:{column:a}}):l("el-table-column",e._b({key:t},"el-table-column",a,!1))]})],2)},x=[],y={name:"ElTableColumns",props:{column:{type:Object,default:()=>({})}}},_=y,g=(0,b.A)(_,f,x,!1,null,null,null),k=g.exports,v={name:"UploadExcelPage",components:{UploadExcel:h,ElTableColumns:k},data(){return{maxSize:1,headers:[{label:"序号",prop:"index"},{label:"姓名",prop:"name"},{label:"性别",prop:"gender"},{label:"公司概况",children:[{label:"职位",prop:"job"},{label:"项目",children:[{label:"公司名称",prop:"company"},{label:"金额",children:[{label:"总金额",prop:"amount"},{label:"利润",prop:"profit"}]},{label:"行业",prop:"field"},{label:"支出",children:[{label:"总支出",prop:"pay"},{label:"外支出",prop:"otherPay"}]},{label:"项目时长",prop:"duration"}]}]},{label:"等级",children:[{label:"职级",prop:"rank"},{label:"学历",prop:"education"}]},{label:"住址",prop:"address"}],tableData:[]}},methods:{beforeUpload(e){if(e.size/1024/1024>this.maxSize)return this.$message.warning(this.$t("uploadExcelPage.outOfSize",{size:`${this.maxSize} MB`})),!1},handleSuccess(){}}},E=v,U=(0,b.A)(E,t,o,!1,null,"530821fb",null),C=U.exports}}]);