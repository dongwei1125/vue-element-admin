"use strict";(self["webpackChunkvue_element_admin"]=self["webpackChunkvue_element_admin"]||[]).push([[861],{2850:function(e,t,a){a.d(t,{x:function(){return c},X:function(){return d}});a(44114);var r=a(32116);function o(e=[],t=0,a=0){for(var r=0;r<e.length;r++){const n=e[r];n.children?.length&&(a=o(n.children,t+1,a))}return Math.max(t,a)}function n(e=[],t=0){for(var a=0;a<e.length;a++){const r=e[a];r.children?.length?t=n(r.children,t):t++}return t}class l{constructor(e=[]){this.list=e,this.getDepth(),this.getLength(),this.getMerges(),this.getAoa(),this.getProps()}getDepth(){this.depth=o(this.list)}getLength(){this.length=n(this.list)}getMerges(){const e=this.depth,t=[];function a(r=[],o=0,n=0){var l,i=0;const d=r.length;for(var p=0;p<d;p++){const d=r[p];if(d.children?.length){const e=n+p+i,t=a(d.children,o+1,e);i+=t,l={s:{r:o,c:e},e:{r:o,c:n+p+i}}}else l={s:{r:o,c:n+p+i},e:{r:e,c:n+p+i}};d.merge=l,t.push(l)}return d-1+i}a(this.list);const r=e=>e.s.r!==e.e.r||e.s.c!==e.e.c,o=t.filter(e=>r(e));this.merges=o}getAoa(){const e=this.depth,t=this.length,a=[...new Array(e+1)].map(e=>new Array(t).fill(""));function r(e=[]){for(var t=0;t<e.length;t++){const o=e[t],n=o.merge.s;o.children?.length&&r(o.children),a[n.r][n.c]=o.label}}r(this.list),this.aoa=a}getProps(){const e=[];function t(a=[]){for(var r=0;r<a.length;r++){const o=a[r];o.children?.length?t(o.children):e.push(o.prop)}}t(this.list),this.props=e}}var i=l;function d(e){const t=e.el||e,a="string"===typeof t?document.querySelector(t):t,o=e.bookName||Date.now(),n=e.bookType||"xlsx",l=e.sheetName||Date.now(),i=r.Wp.book_new(),d=r.Wp.table_to_sheet(a);r.Wp.book_append_sheet(i,d,`${l}`),r._h(i,`${o}.${n}`)}function p(e=[],t=[]){const a=[];for(var r=0;r<t.length;r++){const n=t[r],l=[];for(var o=0;o<e.length;o++){const t=e[o];l.push(n[t])}a.push(l)}return a}function c(e){const t=e.header||[],a=e.data||[],{aoa:o,merges:n,props:l,depth:d}=new i(t),c=p(l,a),s=e.bookName||Date.now(),g=e.bookType||"xlsx",h=e.sheetName||Date.now(),x=r.Wp.book_new(),u=r.Wp.aoa_to_sheet(o);u["!merges"]=n,r.Wp.sheet_add_json(u,c,{origin:`A${d+2}`,skipHeader:!0}),r.Wp.book_append_sheet(x,u,`${h}`),r._h(x,`${s}.${g}`)}},70861:function(e,t,a){a.r(t),a.d(t,{default:function(){return c}});var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"export-merge-header-excel"},[t("div",{staticClass:"export-merge-header-excel-header"},[t("el-input",{attrs:{"prefix-icon":"el-icon-document",placeholder:e.$t("exportMergeHeaderExcelPage.inputName")},model:{value:e.bookName,callback:function(t){e.bookName=t},expression:"bookName"}}),t("el-button",{attrs:{type:"primary",icon:"el-icon-document"},on:{click:e.handleDomExport}},[e._v(" "+e._s(e.$t("exportMergeHeaderExcelPage.domExport"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-document"},on:{click:e.handleDataExport}},[e._v(" "+e._s(e.$t("exportMergeHeaderExcelPage.dataExport"))+" ")])],1),t("el-table",{ref:"table",attrs:{data:e.tableData,border:"","highlight-current-row":""}},[t("el-table-column",{attrs:{label:e.$t("exportMergeHeaderExcelPage.index"),prop:"index",align:"center",width:"80px"}}),t("el-table-column",{attrs:{label:e.$t("exportMergeHeaderExcelPage.name"),prop:"name",align:"center",width:"120px"}}),t("el-table-column",{attrs:{label:e.$t("exportMergeHeaderExcelPage.gender"),prop:"gender",align:"center",width:"100px"}}),t("el-table-column",{attrs:{label:e.$t("exportMergeHeaderExcelPage.overview"),align:"center"}},[t("el-table-column",{attrs:{label:e.$t("exportMergeHeaderExcelPage.job"),prop:"job",align:"center",width:"120px"}}),t("el-table-column",{attrs:{label:e.$t("exportMergeHeaderExcelPage.project"),align:"center"}},[t("el-table-column",{attrs:{label:e.$t("exportMergeHeaderExcelPage.company"),prop:"company","min-wdith":"160px"}}),t("el-table-column",{attrs:{label:e.$t("exportMergeHeaderExcelPage.money"),align:"center"}},[t("el-table-column",{attrs:{label:e.$t("exportMergeHeaderExcelPage.amount"),prop:"amount",align:"center",width:"100px"}}),t("el-table-column",{attrs:{label:e.$t("exportMergeHeaderExcelPage.profit"),prop:"profit",align:"center",width:"100px"}})],1),t("el-table-column",{attrs:{label:e.$t("exportMergeHeaderExcelPage.field"),prop:"field",align:"center",width:"100px"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-tag",[e._v(e._s(a.field))])]}}])}),t("el-table-column",{attrs:{label:e.$t("exportMergeHeaderExcelPage.expense"),align:"center"}},[t("el-table-column",{attrs:{label:e.$t("exportMergeHeaderExcelPage.pay"),prop:"pay",align:"center",width:"100px"}}),t("el-table-column",{attrs:{label:e.$t("exportMergeHeaderExcelPage.otherPay"),prop:"otherPay",align:"center",width:"100px"}})],1),t("el-table-column",{attrs:{label:e.$t("exportMergeHeaderExcelPage.duration"),prop:"duration",align:"center",width:"100px"}})],1)],1),t("el-table-column",{attrs:{label:e.$t("exportMergeHeaderExcelPage.grade"),align:"center"}},[t("el-table-column",{attrs:{label:e.$t("exportMergeHeaderExcelPage.rank"),prop:"rank",align:"center",width:"100px"}}),t("el-table-column",{attrs:{label:e.$t("exportMergeHeaderExcelPage.education"),prop:"education",align:"center",width:"100px"}})],1),t("el-table-column",{attrs:{label:e.$t("exportMergeHeaderExcelPage.address"),prop:"address",width:"140px"}})],1)],1)},o=[],n=a(2850),l={name:"ExportMergeHeaderExcel",data(){return{tableData:[],bookName:""}},mounted(){this.getTableData()},methods:{getTableData(){const e=[{index:1,name:"项羽",gender:"男",job:"项目经理",company:"项目有限公司",amount:"1000W",profit:"100W",field:"建筑",pay:"100W",otherPay:"10W",duration:"5年",education:"本科",rank:"P2",address:"重庆市万州区"},{index:2,name:"虞姬",gender:"女",job:"数据分析师",company:"大数据分析公司",amount:"1200W",profit:"120W",field:"文化",pay:"7W",otherPay:"11W",duration:"6年",education:"大专",rank:"P3",address:"四川省成都市"},{index:3,name:"关羽",gender:"男",job:"行政助理",company:"马儿集团",amount:"800W",profit:"80W",field:"运输",pay:"400W",otherPay:"200W",duration:"7年",education:"本科",rank:"P4",address:"甘肃省兰州市"},{index:4,name:"赵云",gender:"男",job:"会计师",company:"计算器有限公司",amount:"100W",profit:"10W",field:"服务",pay:"30W",otherPay:"2W",duration:"8年",education:"本科",rank:"P3",address:"上海市虹口区"},{index:5,name:"孙尚香",gender:"女",job:"研发",company:"弓箭研发有限公司",amount:"200W",profit:"20W",field:"制造",pay:"5W",otherPay:"1W",duration:"9年",education:"本科",rank:"P1",address:"云南省昆明市"},{index:6,name:"马超",gender:"男",job:"销售",company:"长矛制造有限公司",amount:"300W",profit:"30W",field:"制造",pay:"7W",otherPay:"2W",duration:"3年",education:"本科",rank:"P5",address:"北京市东城区"},{index:7,name:"黄忠",gender:"男",job:"销售经理",company:"炮车制造有限公司",amount:"400W",profit:"40W",field:"制造",pay:"20W",otherPay:"10W",duration:"4年",education:"硕士",rank:"P6",address:"山东省济南市"},{index:8,name:"甄姬",gender:"男",job:"人事助理",company:"猎头有限公司",amount:"500W",profit:"50W",field:"社会",pay:"3W",otherPay:"2W",duration:"1年",education:"硕士",rank:"P4",address:"陕西省铜川市"},{index:9,name:"小乔",gender:"女",job:"文员",company:"文案有限公司",amount:"550W",profit:"55W",field:"文化",pay:"50W",otherPay:"10W",duration:"11年",education:"硕士",rank:"P2",address:"广州省海珠区"},{index:10,name:"上官婉儿",gender:"女",job:"财务",company:"琴棋有限公司",amount:"2000W",profit:"200W",field:"娱乐",pay:"100W",otherPay:"50W",duration:"20年",education:"硕士",rank:"P8",address:"河南省郑州市"}];this.tableData=e},handleDomExport(){const e=this.$refs.table?.$el;(0,n.X)({el:e,bookName:this.bookName})},handleDataExport(){const e=[{label:this.$t("exportMergeHeaderExcelPage.index"),prop:"index"},{label:this.$t("exportMergeHeaderExcelPage.name"),prop:"name"},{label:this.$t("exportMergeHeaderExcelPage.gender"),prop:"gender"},{label:this.$t("exportMergeHeaderExcelPage.overview"),children:[{label:this.$t("exportMergeHeaderExcelPage.job"),prop:"job"},{label:this.$t("exportMergeHeaderExcelPage.project"),children:[{label:this.$t("exportMergeHeaderExcelPage.company"),prop:"company"},{label:this.$t("exportMergeHeaderExcelPage.money"),children:[{label:this.$t("exportMergeHeaderExcelPage.amount"),prop:"amount"},{label:this.$t("exportMergeHeaderExcelPage.profit"),prop:"profit"}]},{label:this.$t("exportMergeHeaderExcelPage.field"),prop:"field"},{label:this.$t("exportMergeHeaderExcelPage.expense"),children:[{label:this.$t("exportMergeHeaderExcelPage.pay"),prop:"pay"},{label:this.$t("exportMergeHeaderExcelPage.otherPay"),prop:"otherPay"}]},{label:this.$t("exportMergeHeaderExcelPage.duration"),prop:"duration"}]}]},{label:this.$t("exportMergeHeaderExcelPage.grade"),children:[{label:this.$t("exportMergeHeaderExcelPage.rank"),prop:"rank"},{label:this.$t("exportMergeHeaderExcelPage.education"),prop:"education"}]},{label:this.$t("exportMergeHeaderExcelPage.address"),prop:"address"}];(0,n.x)({header:e,data:this.tableData,bookName:this.bookName})}}},i=l,d=a(81656),p=(0,d.A)(i,r,o,!1,null,"3a3adcd2",null),c=p.exports}}]);