"use strict";(self["webpackChunkvue_element_admin"]=self["webpackChunkvue_element_admin"]||[]).push([[2792],{2850:function(e,t,o){o.d(t,{x:function(){return h},X:function(){return s}});o(44114);var a=o(32116);function n(e=[],t=0,o=0){for(var a=0;a<e.length;a++){const i=e[a];i.children?.length&&(o=n(i.children,t+1,o))}return Math.max(t,o)}function i(e=[],t=0){for(var o=0;o<e.length;o++){const a=e[o];a.children?.length?t=i(a.children,t):t++}return t}class r{constructor(e=[]){this.list=e,this.getDepth(),this.getLength(),this.getMerges(),this.getAoa(),this.getProps()}getDepth(){this.depth=n(this.list)}getLength(){this.length=i(this.list)}getMerges(){const e=this.depth,t=[];function o(a=[],n=0,i=0){var r,l=0;const s=a.length;for(var c=0;c<s;c++){const s=a[c];if(s.children?.length){const e=i+c+l,t=o(s.children,n+1,e);l+=t,r={s:{r:n,c:e},e:{r:n,c:i+c+l}}}else r={s:{r:n,c:i+c+l},e:{r:e,c:i+c+l}};s.merge=r,t.push(r)}return s-1+l}o(this.list);const a=e=>e.s.r!==e.e.r||e.s.c!==e.e.c,n=t.filter(e=>a(e));this.merges=n}getAoa(){const e=this.depth,t=this.length,o=[...new Array(e+1)].map(e=>new Array(t).fill(""));function a(e=[]){for(var t=0;t<e.length;t++){const n=e[t],i=n.merge.s;n.children?.length&&a(n.children),o[i.r][i.c]=n.label}}a(this.list),this.aoa=o}getProps(){const e=[];function t(o=[]){for(var a=0;a<o.length;a++){const n=o[a];n.children?.length?t(n.children):e.push(n.prop)}}t(this.list),this.props=e}}var l=r;function s(e){const t=e.el||e,o="string"===typeof t?document.querySelector(t):t,n=e.bookName||Date.now(),i=e.bookType||"xlsx",r=e.sheetName||Date.now(),l=a.Wp.book_new(),s=a.Wp.table_to_sheet(o);a.Wp.book_append_sheet(l,s,`${r}`),a._h(l,`${n}.${i}`)}function c(e=[],t=[]){const o=[];for(var a=0;a<t.length;a++){const i=t[a],r=[];for(var n=0;n<e.length;n++){const t=e[n];r.push(i[t])}o.push(r)}return o}function h(e){const t=e.header||[],o=e.data||[],{aoa:n,merges:i,props:r,depth:s}=new l(t),h=c(r,o),p=e.bookName||Date.now(),d=e.bookType||"xlsx",u=e.sheetName||Date.now(),m=a.Wp.book_new(),g=a.Wp.aoa_to_sheet(n);g["!merges"]=i,a.Wp.sheet_add_json(g,h,{origin:`A${s+2}`,skipHeader:!0}),a.Wp.book_append_sheet(m,g,`${u}`),a._h(m,`${p}.${d}`)}},42792:function(e,t,o){o.r(t),o.d(t,{default:function(){return p}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"export-excel"},[t("div",{staticClass:"export-excel-header"},[t("div",[t("span",{staticClass:"title"},[e._v(e._s(e.$t("exportExcelPage.bookName")))]),t("el-input",{attrs:{"prefix-icon":"el-icon-document",placeholder:e.$t("exportExcelPage.inputName")},model:{value:e.form.bookName,callback:function(t){e.$set(e.form,"bookName",t)},expression:"form.bookName"}})],1),t("div",[t("span",{staticClass:"title"},[e._v(e._s(e.$t("exportExcelPage.autoWidth")))]),t("el-checkbox",{attrs:{border:""},model:{value:e.form.autoWidth,callback:function(t){e.$set(e.form,"autoWidth",t)},expression:"form.autoWidth"}})],1),t("div",[t("span",{staticClass:"title"},[e._v(e._s(e.$t("exportExcelPage.bookType")))]),t("el-select",{model:{value:e.form.bookType,callback:function(t){e.$set(e.form,"bookType",t)},expression:"form.bookType"}},e._l(e.options,function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),t("el-button",{attrs:{type:"primary",icon:"el-icon-document"},on:{click:e.handleExport}},[e._v(" "+e._s(e.$t("exportExcelPage.export"))+" ")])],1),t("el-table",{ref:"table",attrs:{data:e.tableData,border:"","highlight-current-row":""}},[t("el-table-column",{attrs:{label:e.$t("exportExcelPage.index"),prop:"index",align:"center",width:"80px"}}),t("el-table-column",{attrs:{label:e.$t("exportExcelPage.title"),prop:"title","min-width":"300px"}}),t("el-table-column",{attrs:{label:e.$t("exportExcelPage.author"),prop:"author",align:"center",width:"140px"},scopedSlots:e._u([{key:"default",fn:function({row:o}){return[t("el-tag",[e._v(e._s(o.author))])]}}])}),t("el-table-column",{attrs:{label:e.$t("exportExcelPage.pageviews"),prop:"pageviews",align:"center",width:"120px"}}),t("el-table-column",{attrs:{label:e.$t("exportExcelPage.datetime"),prop:"datetime",align:"center",width:"200px"},scopedSlots:e._u([{key:"default",fn:function({row:o}){return[t("i",{staticClass:"el-icon-time"}),t("span",[e._v(e._s(o.datetime))])]}}])})],1)],1)},n=[],i=o(2850);const r={bookName:"",autoWidth:!0,bookType:"xlsx"};var l={name:"ExportExcel",data(){return{options:["xlsx","csv","txt"],tableData:[],form:{...r}}},mounted(){this.getTableData()},methods:{getTableData(){const e=[{index:1,author:"Sandra",title:"Emyoxuw Jgfjngnqj Elpwiruss Qqbeyk Vnqpjl Qodt Xyuei",datetime:"2009/03/13 16:33:32",pageviews:3784},{index:2,author:"David",title:"Abhybe Xhnvqv Dadwkaiei Oxncmcqwx Ibskq Ymnwnyqc Xygdbguet",datetime:"1996/09/06 10:29:31",pageviews:395},{index:3,author:"Maria",title:"Jqeuwyriu Lratpq Fmsok Qvqcewgrcz Vswp Osbnniywm Dnrivoke",datetime:"1971/11/16 03:08:02",pageviews:1644},{index:4,author:"Sarah",title:"Qoqywfrf Koprq Mtpuhup Dlqluube Yrciqk Ynwx Ndetnirm Gnkhyxbep Abx",datetime:"2005/07/30 14:10:01",pageviews:3338},{index:5,author:"Joseph",title:"Vdgqw Rkkj Nvmj Jnhxyx Mcceqgi Twnu Jyksakb Bsqlowwljt",datetime:"1990/09/06 21:17:21",pageviews:4573},{index:6,author:"Frank",title:"Glyoblgg Fjfm Wugvu Mtpdhmyj Cdeyjsqqt Jibjdt Khagjy Bbmauzrxg Qboxfm Nqyshfoe",datetime:"1978/09/23 11:04:21",pageviews:770},{index:7,author:"Christopher",title:"Gjdbqqc Tlktf Klms Gcnjzguy Jksm Vddvvi Dsi Ahihq Aonqgmj",datetime:"2016/10/25 09:38:14",pageviews:708},{index:8,author:"Lisa",title:"Wycmm Zji Puxxojcgd Dvrx Enfqxif Nmxkp Ilncd",datetime:"2012/02/10 07:30:12",pageviews:799},{index:9,author:"Jessica",title:"Euhqj Vjcdyubbar Halcjpk Myyoqdy Afcckbn Vchriilj Jabrlry",datetime:"1977/03/06 00:15:57",pageviews:4538},{index:10,author:"Edward",title:"Luji Fvmpl Rxjxxk Firmtpo Ghh Jdbn",datetime:"1990/06/12 21:58:51",pageviews:3234}];this.tableData=e},handleExport(){const{bookName:e,bookType:t}=this.form,o=this.$refs.table?.$el;(0,i.X)({el:o,bookName:e,bookType:t})}}},s=l,c=o(81656),h=(0,c.A)(s,a,n,!1,null,"68d348cc",null),p=h.exports}}]);